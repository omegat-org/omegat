parameters:
  - name: omegatVersion
    default: ''

steps:
  - task: Bash@3
    condition: or(eq(variables.isMain, true), eq(variables.isReleasesBranch, true))
    displayName: ðŸ“‚ SCP upload to sourceforge file management
    inputs:
      targetType: 'inline'
      script: |
        echo "Push OmegaT ${{ parameters.omegatVersion }} files to SourceForge file manager"
        srcdir=$(system.defaultworkingdirectory)/build/distributions/
        dest=$(SOURCEFORGE_FILE_USER)@frs.sourceforge.net
        destdir=/home/frs/project/omegat/Weekly
        echo "mkdir $destdir" | SSHPASS=$(SOURCEFORGE_FILE_PASS) sshpass -e sftp -v $dest || true
        SSHPASS=$(SOURCEFORGE_FILE_PASS) sshpass -e scp -v -oStrictHostKeyChecking=no $srcdir/* $dest:$destdir
