<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "../../../docbook-xml-4.5/docbookx.dtd">
<chapter id="chapter.translation.memories">
  <title>Память переводов<indexterm class="singular">
      <primary>Память переводов</primary>
    </indexterm><indexterm class="singular">
      <primary>TMX</primary> <see>Память переводов</see>
    </indexterm></title>

  <section id="OmegaT.and.tmx.files">
    <title>Память переводов в ОмегаТ</title>

    <section id="tmx.files.location.and.purpose">
      <title>Каталоги tmx - расположение и назначение</title>

      <para>В проектах <application>ОмегаТ</application> файлы памяти перевода, т. е. файлы с расширением «tmx», могут храниться в четырёх разных местах.</para>

      <variablelist>
        <varlistentry>
          <term><indexterm class="singular">
              <primary>Память переводов</primary> <secondary>Подкаталог «omegat»</secondary> <seealso>Файлы прокта</seealso>
            </indexterm>подкаталог «omegat»</term>

          <listitem>
            <para>Папка «omegat» содержит файл <filename>project_save.tmx</filename> и, возможно, некоторое количество его резервных копий. Файл <filename>project_save.tmx</filename> содержит все сегменты, которые были сохранены в памяти программы с момента начала проекта. Этот файл всегда присутствует во всех проектах. Его содержимое всегда отсортировано по исходным сегментам в алфавитном порядке.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><indexterm class="singular">
              <primary>Память переводов</primary> <secondary>Главный каталог проекта</secondary>
            </indexterm>главный каталог проекта</term>

          <listitem>
            <para>Главный каталог проекта содержит три TMX-файла: <filename>имя_проекта-omegat.tmx</filename>, <filename>имя_проекта-level1.tmx</filename> и <filename>имя_проекта-level2.tmx</filename>.</para>

            <itemizedlist>
              <listitem>
                <para>Файл «level1» содержит только текстовую информацию.</para>
              </listitem>

              <listitem>
                <para>Файл «level2» инкапсулирует специфические теги <application>ОмегаТ</application> в стандартные теги TMX, чтобы этот файл можно было использовать (со всей информацией о форматировании) в любом переводческом ПО, которое поддерживает TMX 2 уровня, или в самой <application>ОмегаТ</application>.</para>
              </listitem>

              <listitem>
                <para>Файл <application>omegat</application> включает специфические теги форматирования <application>ОмегаТ</application>, так что его можно использовать в других проектах <application>ОмегаТ</application>.</para>
              </listitem>
            </itemizedlist>

            <para>Эти файлы представляют собой копии <filename>project_save.tmx</filename>, т. е. главной памяти переводов проекта, за исключением ничейных сегментов. Им специально присвоены разные имена, чтобы всегда можно было понять, что находится в данном, конкретном файле. Это может быть полезно, например, когда TMX-файл находится в подкаталоге <filename>«tm»</filename> другого проекта.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>подкаталог <filename><indexterm class="singular">
              <primary>Память переводов</primary> <secondary>Подкаталог «tm»</secondary> <seealso>Файлы прокта</seealso>
            </indexterm>«tm»</filename></term>

          <listitem>
            <para>Каталог «/tm/» может содержать любое количество справочных TMX-файлов. Эти файлы могут быть в любом из трёх описанных выше вариантах. Заметьте, что другие системы автоматизированного перевода могут также производить экспорт (и импорт) TMX-файлов во всех вариантах. Лучше всего, конечно, использовать TMX-файлы со специфичными для ОмегаТ тегами (см. выше), чтобы сохранить информацию о внутреннем форматировании сегментов.</para>

            <para>Содержимое файлов памяти переводов из каталога «tm» используется при поиске нечётких совпадений в переводимом тексте. Любые хранящиеся в этих файлах сегменты, достаточно схожие с сегментами переводимого текста, будут показываться в области просмотра нечётких совпадений.</para>

            <para>Если какой-либо из хранящихся в справочных TMX-файлах сегментов полностью совпадёт с текущим переводимым сегментом, поведение ОмегаТ будет зависеть от настроек, заданных в диалоговом окне <menuchoice> <guimenu>«Параметры</guimenu> <guimenuitem>Параметры редактирования...»</guimenuitem> </menuchoice>. Например (если заданы настройки по умолчанию), перевод из справочной памяти переводов может быть принят, и вставлен как перевод сегмента с префиксом <emphasis>[нечёткое совпадение]</emphasis>, так что в дальнейшем переводчик сможет легко найти подобные сегменты и проверить их (см. раздел <link linkend="chapter.translation.editing">Параметры редактирования</link>) <menuchoice> <guimenu>.</guimenu> </menuchoice></para>

            <para>Иногда файлы памяти переводов из папки <filename>tm</filename> содержат сегменты с одинаковым исходным текстом, но разными переводами. ОмегаТ считывает TMX-файлы в алфавитном порядке, строка за строкой. Соответственно, последний из сегментов с одинаковым исходным текстом будет иметь преимущество (примечание: хотя, конечно же, подобного рода ситуации следует избегать).</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term><indexterm class="singular">
              <primary>Память переводов</primary> <secondary>Подкаталог «tm/auto»</secondary> <seealso>Файлы проекта</seealso>
            </indexterm>подкаталог «tm/auto»<indexterm class="singular">
              <primary>Проект</primary> <secondary>Предварительный перевод</secondary>
            </indexterm></term>

          <listitem>
            <para>Если заранее известно, что хранящиеся в TMX-файле переводы корректны (полностью подходят для текущего проекта), можно поместить TMX-файл в подкаталог <emphasis role="bold">tm/auto</emphasis>, что позволит избежать необходимости удалять подстроку <emphasis>[нечёткое совпадение]</emphasis> из множества автоматически вставленных переводов. Это позволит легко создать <emphasis role="bold">предварительный перевод</emphasis> исходного текста: все исходные сегменты, для которых в файлах из папки «auto» найдутся точные совпадения, будут переведены без какого-либо участия со стороны пользователя.</para>
          </listitem>
        </varlistentry>
      </variablelist>

      <para>Также, можно указать <application>ОмегаТ</application> создать дополнительный TMX-файл (в формате <application>*-omegat-*</application>) со всеми сегментами проекта. См. ниже подраздел о памяти псевдо-переводов.</para>

      <para>Помните, что файлы памяти переводов загружаются в память при открытии проекта. Резервное копирование памяти переводов проекта происходит регулярно (см. следующий раздел), также файл <filename>project_save.tmx</filename> сохраняется/обновляется при каждой загрузке и закрытии проекта. Это означает, например, что если вы добавите в проект новый справочный TMX-файл, то будет достаточно перезагрузить проект, все ваши переводы будут сохранены.</para>

      <para>Расположение различных файлов памяти перевода для текущего проекта задаётся пользователем (см. раздел <link linkend="chapter.instant.start.guide">Быстрый старт</link>).</para>

      <para>В зависимости от потребностей, можно применять различные стратегии перевода, например:</para>

      <para><emphasis role="bold">несколько проектов со схожей тематикой: </emphasis> используйте единый каталог для всех проектов, заменяйте только каталоги исходных и переведённых файлов (исходные файлы в «source/order1», переведённые файлы в «target/order1» и т.д.). Заметьте, что переводы сегментов из файлов в каталоге «order1», которые отсутствуют в «order2» или других работах, будут помечаться как «ничейные», что, однако, никак не помешает использовать их как источник нечётких совпадений.</para>

      <para><emphasis role="bold">несколько переводчиков, работающих над одним проектом:</emphasis> разделите каталог исходных файлов на «source/Mihail», «source/Viacheslav»… и назначьте их членам команды (Михаилу, Вячеславу и т.д.). Они могут создать собственные проекты и предоставить <filename>project_save.tmx</filename> по окончанию проекта, или после перевода определённого количества текстов. Затем, файлы <filename>project_save.tmx</filename> собираются вместе и анализируются, например, чтобы исключить несоответствия в терминологии. Создаётся новая версия главного TMX-файла, который либо помещается в каталог <emphasis>tm/auto</emphasis> каждого члена команды, либо служит заменой их файлов <filename>project_save.tmx</filename>. Команда может использовать общий каталог переведённых файлов. Это позволяет, например, в любой момент убедиться, что перевод всего проекта корректен.</para>
    </section>

    <section id="tmx.backup">
      <title>Резервное копирование TMX-файлов<indexterm class="singular">
          <primary>Память переводов</primary> <secondary>Резервное копирование</secondary>
        </indexterm></title>

      <para>По мере перевода ваших фалов, <application>ОмегаТ</application> сохраняет память переводов в файле <filename>project_save.tmx</filename>, находящемся в подкаталоге <filename>omegat</filename>.</para>

      <para>Кроме того, <application>ОмегаТ</application> сохраняет резервные копии памяти переводов в файлах <filename>project_save.tmx.ГГГММДДЧЧНН.bak</filename> в той же папке при каждом открытии или перезагрузке проекта. ГГГГ — это год (4 цифры), ММ — это месяц, ДД — это число, а ЧЧ и НН — это часы и минуты, прошедшие с момента сохранения предыдущей резервной копии.</para>

      <para>Если вам кажется, что вы потеряли свой перевод, сделайте следующее:</para>

      <orderedlist>
        <listitem>
          <para>Закройте проект</para>
        </listitem>

        <listitem>
          <para>Переименуйте файл <filename>project_save.tmx</filename> (например, в <filename>project_save.tmx.temporary</filename>)</para>
        </listitem>

        <listitem>
          <para>Выберите резервную копию, которая скорее всего содержит нужные вам данные, например, самую последнюю, или последнюю копию за вчерашний день.</para>
        </listitem>

        <listitem>
          <para>Переименуйте его в <filename>project_save.tmx</filename></para>
        </listitem>

        <listitem>
          <para>Откройте проект</para>
        </listitem>
      </orderedlist>
    </section>

    <section id="tmx.files.and.language">
      <title>TMX-файлы и язык<indexterm class="singular">
          <primary>Память переводов</primary> <secondary>Язык</secondary>
        </indexterm></title>

      <para>Файлы TMX содержат единицы перевода, которые состоят из определённого количества эквивалентных сегментов на разных языках. Единица перевода состоит из, как минимум, двух вариаций единицы перевода (translation unit variation, TUV). Любую из них можно использовать и как оригинал, и как перевод.</para>

      <para>Языки перевода и оригинала определяются из настроек проекта. Таким образом, ОмегаТ находит вариации единиц перевода соответствующие языковым кодам проекта и рассматривает их как сегменты оригинала и перевода. ОмегаТ распознаёт языковые коды в двух форматах:</para>

      <itemizedlist>
        <listitem>
          <para>двух-буквенные коды (например, JA для японского), или</para>
        </listitem>

        <listitem>
          <para>двух- или трёх-буквенные коды, за которыми идёт двух-буквенный код страны (например, EN-US, см <xref linkend="appendix.languages"/> неполный список кодов языков).</para>
        </listitem>
      </itemizedlist>

      <para>Если языковые коды проекта и файла TMX полностью совпадают, сегменты загружаются в память. Если совпадает только язык, но не страна, сегменты всё равно загружаются в память. Если не совпадает ни один код, сегменты не загружаются.</para>

      <para><indexterm class="singular">
          <primary>Память переводов</primary> <secondary>Работа с многоязычными файлами</secondary>
        </indexterm>В общем случае TMX-файлы могут содержать единицы перевода на разных языках. Если в памяти переводов для текущего сегмента нет совпадений на языке перевода, будут показаны все остальные совпадения, вне зависимости от языка. Например, если в проекте производится перевод с немецкого на французский, перевод текущего сегмента с немецкого на английский может всё равно оказаться полезным.</para>
    </section>

    <section>
      <title>Ничейные сегменты<indexterm class="singular">
          <primary>Память переводов</primary> <secondary>Ничейные сегменты</secondary>
        </indexterm></title>

      <para>Файл <filename>project_save.tmx</filename> содержит все сегменты, которые были переведены с момента начала проекта. После изменения правил сегментации или удаления файлов из каталога «source» некоторые совпадения могут отображаться в области просмотра как <emphasis role="bold">«ничейные»</emphasis>: такие совпадения соответствуют сегментам, которых больше нет в исходных документах, эти сегменты были переведены и сохранены в памяти до своего удаления.</para>
    </section>
  </section>

  <section id="using.translation.memories.from.previous.projects">
    <title>Повторное использование памяти переводов<indexterm class="singular">
        <primary>Память переводов</primary> <secondary>Импорт и экспорт</secondary>
      </indexterm><indexterm class="singular">
        <primary>Память переводов</primary> <secondary>Повторное использование памяти переводов</secondary>
      </indexterm></title>

    <para>Изначально, сразу после создания проекта, главный файл памяти переводов, <filename>project_save.tmx</filename>, пуст. По мере перевода этот TMX-файл будет наполняться. Для ускорения этого процесса можно использовать уже имеющиеся переводы. Если текущий сегмент уже был переведён ранее и переведён хорошо, переводить его заново нет никакой необходимости. Также, сегменты из памяти перевода могут использоваться как образцы специфического стиля, типичный пример — международные документы, публикуемые Европейским Союзом.</para>

    <para>При создании переведённых документов память переводов проекта также сохраняется в виде трёх файлов в главной папке проекта (см. выше). Эти три TMX-файла (<filename>«-omegat.tmx»</filename>, <filename>«-level1.tmx»</filename> и <filename>«-level2.tmx»</filename>) можно рассматривать как «память переводов на экспорт», то есть, как экспортированную двуязычную сводку вашего проекта.</para>

    <para>Если вы пожелаете повторно использовать память переводов из предыдущего проекта (например, потому что новый проект похож на предыдущий или использует терминологию, которая была задействована раньше), то вы можете подключить эту память переводов как «внешнюю» по отношению к вашему новому проекту. В этом случае поместите файлы памяти переводов, которые вы хотите использовать, в каталоги <emphasis>/tm</emphasis> или <emphasis>/tm</emphasis>/auto вашего нового проекта. Файлы из каталога «tm» будут использоваться для поиска нечётких совпадений, а файлы каталога «/tm/auto» — для создания предварительного перевода вашего проекта.</para>

    <para>По умолчанию, каталог «\tm» находится в главном каталоге проекта (например, <emphasis>/MyProject/tm</emphasis>), но, при желании, в диалоговом окне свойств проекта вы можете задать и другое расположение. Это полезно, если вы часто используете файлы памяти переводов, созданные раннее, например, потому что они относятся к одной теме или к одному клиенту. В таком случае, может быть полезно прибегнуть к такой процедуре:</para>

    <itemizedlist>
      <listitem>
        <para>Создайте каталог (репозиторий, хранилище) в удобном месте на вашем жёстком диске. Он будет использоваться для конкретного клиента или конкретной тематики.</para>
      </listitem>
    </itemizedlist>

    <itemizedlist>
      <listitem>
        <para>После окончания работы над проектом, скопируйте один из трёх «экспортных» файлов памяти переводов из главного каталога проекта в каталог-репозиторий.</para>
      </listitem>
    </itemizedlist>

    <itemizedlist>
      <listitem>
        <para>Когда вы начинаете работу над новым проектом для того же клиента или по той же тематике, выберите пункт меню <guimenuitem>«Проект &gt; Свойства...»</guimenuitem> и в появившемся диалоговом окне в качестве папки памяти переводов укажите каталог-репозиторий.</para>
      </listitem>
    </itemizedlist>

    <para>Имейте в виду, что все TMX-файлы в репозитории «/tm» обрабатываются во время запуска программы, поэтому если вы поместите туда все имеющиеся у вас TMX-файлы, то можете несколько замедлить работу ОмегаТ. Возможно, часть этих файлов можно будет удалить, после того, как их содержимое перейдёт в <filename>project-save.tmx</filename> вашего текущего проекта.</para>

    <section>
      <title>Импорт и экспорт памяти переводов</title>

      <para>ОмегаТ поддерживает импорт файлов TMX версий 1.1-1.4b (уровней 1 и 2). Это позволяет ОмегаТ использовать память переводов, созданную другими программами. Однако, импорт TMX-файлов 2 уровня (которые содержат не только перевод, но и форматирование) поддерживается не полностью. ОмегаТ может импортировать TMX-файлы второго уровня и использовать содержащуюся в них текстовую информацию, но качество нечётких совпадений будет несколько ниже.</para>

      <para>ОмегаТ использует очень жёсткие правила обработки файлов памяти переводов (файлов TMX). Если в таком файле обнаружится ошибка, ОмегаТ укажет её расположение в некорректном файле.</para>

      <para>Некоторые программы иногда производят некорректные файлы TMX. Если вы всё же хотите их использовать в ОмегаТ, то сначала их необходимо исправить, иначе OmegaT не сможет их загрузить и сообщит об ошибке. Исправлять эти файлы достаточно легко, ОмегаТ даст вам нужные подсказки в соответствующем сообщении об ошибке. Если проблему решить не удалось, можно попросить помощи в списке рассылки пользователей ОмегаТ.</para>

      <para><application/>ОмегаТ экспортирует TMX-файлы версии 1.4 (1 и 2 уровня). На самом деле, экспорт 2 уровня не совсем соответствует стандарту, но достаточен для того, чтобы эти файлы давали корректные совпадения в программах, поддерживающих TMX 2 уровня. Если вам нужна только текстовая информация (без форматирования), используйте созданный ОмегаТ файл 1 уровня.</para>
    </section>
  </section>

  <section id="pseudo.translated.memory">
    <title>Память псевдо-перевода<indexterm class="singular">
        <primary>Память переводов</primary> <secondary>Псевдо-перевод</secondary>
      </indexterm></title>

    <note>
      <para>Этот раздел предназначен для опытных пользователей!</para>
    </note>

    <para>Иногда перед собственно переводом, может понадобиться предварительная обработка сегментов, вне ОмегаТ. Например, вы можете захотеть создать псевдо-перевод, чтобы как-нибудь с ним поэкспериментировать. ОмегаТ позволяет создать дополнительный TMX-файл, который содержит все сегменты проекта. Переводы в этом файле либо:</para>

    <itemizedlist>
      <listitem>
        <para>будут копировать оригинал (поведение по умолчанию)</para>
      </listitem>
    </itemizedlist>

    <itemizedlist>
      <listitem>
        <para>будут пустыми</para>
      </listitem>
    </itemizedlist>

    <para>Вы можете указать для этого файла любое имя. Память псевдо-перевода создаётся следующей командой (в командной строке):</para>

    <para><literal>java -jar omegat.jar --pseudotranslatetmx=&lt;имяфайла&gt; [pseudotranslatetype=[equal|empty]]</literal></para>

    <para>Замените <literal>&lt;имяфайла&gt;</literal> на конкретное имя файла, который вы хотите создать. Имя может быть абсолютным или относительным к текущему каталогу (каталогу, из которого запускается <application>ОмегаТ</application>). Второй аргумент (<literal>--pseudotranslatetype</literal>) не обязателен. Он может принимать значения <literal>equal</literal> (поведение по умолчанию, перевод копирует оригинал) или <literal>empty</literal> (сегмент перевода будет пустым). В дальнейшем вы можете обрабатывать созданный TMX-файл при помощи любой доступной вам программы. Чтобы повторно использовать его в <application>ОмегаТ</application>, переименуйте файл в <emphasis>project_save.tmx </emphasis> и поместите в папку <literal>omegat</literal> вашего проекта.</para>
  </section>

  <section id="upgrading.translation.memories">
    <title>Обновление файлов памяти переводов<indexterm class="singular">
        <primary>Память переводов</primary> <secondary>Обновление файлов памяти переводов для сегментации по предложениям</secondary>
      </indexterm></title>

    <para>Ранние версии <application>ОмегаТ</application> умели производить сегментацию исходных файлов только по абзацам и непоследовательно нумеровали теги форматирования в файлах HTML и Open Document. <application>ОмегаТ</application> 2.5 может определять и исправлять такие TMX-файлы «на лету», что позволяет улучшить качество нечётких совпадений и более эффективно использовать существующие переводы, тем самым освобождая переводчика от лишней работы.</para>

    <para>Главный TMX-файл проекта обновляется только один раз и записывается в <filename>project-save.tmx</filename>. Обычные старые TMX-файлы обновляются «на лету» каждый раз при загрузке проекта. Следует иметь в виду, что некоторые изменения в фильтрах <application>ОмегаТ</application> 2.5 могут привести к совершенно другой сегментации, поэтому иногда (в редких случаях) вам придётся обновлять перевод вручную.</para>
  </section>
</chapter>